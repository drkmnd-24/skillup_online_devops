{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkillUp Dashboard</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script type="module" src="{% static 'js/config.js' %}"></script>
    <script type="module" src="{% static 'js/auth.js' %}"></script>
    <script type="module" src="{% static 'js/profile.js' %}"></script>
    <script type="module" src="{% static 'js/tasks.js' %}"></script>
    <script type="module" src="{% static 'js/ui.js' %}"></script>
  </head>
  <body>
    <div class="navbar">
      <h2>Welcome <span id="user-knox-id"></span> to CNF</h2>
    </div>
    <div class="container"
         id="task-detail-container"
         data-task-id="{{task.id}}"
         data-time-limit="{{time_limit|default:30}}"
         data-is-review="{% if is_review %}true{% else %}false{% endif %}">

      <div id="countdown-timer" style="display: none; font-weight: bold; margin-top: 20px;">
        Time Remaining: <span id="timer-value"></span>
      </div>

      <h2>{{ task.title }}</h2>
      <p><strong>Description:</strong> {{ task.description }}</p>

      {% if task.status == 'assigned' or task.status == 'ongoing' %}
        <button id="start-task-btn" class="btn btn-primary">Start Task</button>
        <button id="submit-task-btn" class="btn btn-success" style="display: none;">Submit Task</button>
        <div id="markdown-content" style="display: none; margin-top: 20px;">
          {{ render_markdown|safe }}
        </div>
      {% elif task.status == 'submitted' %}
        <p><em>Task Submitted. Time Taken {{ task.time_taken }} seconds</em></p>
        <div id="markdown-content">
          {{ render_markdown|safe }}
        </div>
      {% else %}
        {% if is_review %}
          <p><em>Review Mode: This task is completed. The entire markdown is below:</em></p>
          <div style="margin-top: 20px;">
            {{ render_markdown|safe }}
          </div>
        {% else %}
          <p><em>This task is completed. Waiting for admin to pass/fail</em></p>
        {% endif %}
      {% endif %}
    </div>
  </body>
  <script type="module" src="{% static 'js/taskDetail.js' %}"></script>
</html>
